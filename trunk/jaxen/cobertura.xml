<?xml version="1.0" encoding="UTF-8"?>

<!--build.xml generated by maven from project.xml version 1.1-beta-3
  on date January 27 2004, time 1423-->

<project default="jar" name="jaxen" basedir=".">

  <property name="defaulttargetdir" value="target" />
  <property name="libdir" value="target/lib" />
  <property name="classesdir" value="target/classes" />
  <property name="testclassesdir" value="target/test-classes" />
  <property name="testreportdir" value="target/test-reports" />
  <property name="coveragedir" value="target/coverage" />
  
  <target name="init" description="o Initializes some properties">
    <mkdir dir="${libdir}" />
    <condition property="noget">
      <equals arg2="only" arg1="${build.sysclasspath}" />
    </condition>
  </target>
  
  <target name="compile" description="o Compile the code" depends="get-deps">
    <mkdir dir="${classesdir}" />
    <javac destdir="${classesdir}" deprecation="true" debug="true" optimize="false" excludes="**/package.html">
      <src>
        <pathelement location="src/java/main" />
      </src>
      <classpath>
        <fileset dir="${libdir}">
          <include name="*.jar" />
        </fileset>
      </classpath>
    </javac>
    <copy todir="${testclassesdir}">
      <fileset dir="src/java/test">
        <include name="**/*.werk" />
        <include name="**/*.xml" />
        <include name="**/*.properties" />
      </fileset>
    </copy>
  </target>

  <target name="compile-tests" depends="compile">
    <mkdir dir="${testclassesdir}" />
    <javac destdir="${testclassesdir}" deprecation="true" debug="true" optimize="false" excludes="**/package.html">
      <src>
        <pathelement location="src/java/test" />
      </src>
      <classpath>
        <fileset dir="${libdir}">
          <include name="*.jar" />
        </fileset>
        <pathelement path="${classesdir}" />
      </classpath>
    </javac>
    <copy todir="${testclassesdir}">
      <fileset dir="src/java/test">
        <include name="**/*.werk" />
        <include name="**/*.xml" />
        <include name="**/*.properties" />
      </fileset>
    </copy>
  </target>
  
  <target name="clean" description="o Clean up the generated directories">
    <delete dir="${defaulttargetdir}" />
  </target>

  <target name="get-deps" unless="noget" depends="init">
    <!--Proxy settings works only with a JDK 1.2 and higher.-->

    <setproxy>
    </setproxy>
    <get dest="${libdir}/dom4j-1.5.2.jar" usetimestamp="true" ignoreerrors="true" src="http://www.ibiblio.org/maven//dom4j/jars/dom4j-1.5.2.jar">
    </get>
    <get dest="${libdir}/jdom-1.0.jar" usetimestamp="true" ignoreerrors="true" src="http://www.ibiblio.org/maven//jdom/jars/jdom-1.0.jar">
    </get>
    <get dest="${libdir}/xmlParserAPIs-2.6.2.jar" usetimestamp="true" ignoreerrors="true" src="http://www.ibiblio.org/maven//xerces/jars/xmlParserAPIs-2.6.2.jar">
    </get>
    <get dest="${libdir}/xercesImpl-2.6.2.jar" usetimestamp="true" ignoreerrors="true" src="http://www.ibiblio.org/maven//xerces/jars/xercesImpl-2.6.2.jar">
    </get>
    <get dest="${libdir}/xom-1.0b3.jar" usetimestamp="true" ignoreerrors="true" src="http://www.ibiblio.org/maven//xom/jars/xom-1.0b3.jar">
    </get>
  </target>
  <target name="install-maven">
    <get dest="${user.home}/maven-install-latest.jar" usetimestamp="true" src="${repo}/maven/maven-install-latest.jar">
    </get>
    <unjar dest="${maven.home}" src="${user.home}/maven-install-latest.jar">
    </unjar>
  </target>


  <taskdef classpath="cobertura.jar" resource="tasks.properties"/>		
		
    <target name="instrument" depends="compile-tests">
      <cobertura-instrument todir="target/instrumented-classes">
        <fileset dir="target/classes">
          <include name="**/*.class"/>
        </fileset> 
      </cobertura-instrument>		
    </target>

  <target name="cover-test" depends="instrument">
    <mkdir dir="${testreportdir}" />
    <junit dir="./" failureproperty="test.failure" printSummary="yes" 
           fork="true" haltonerror="true">
      <classpath location="cobertura.jar"/>
      <classpath location="target/instrumented-classes"/>
      <classpath>
        <fileset dir="${libdir}">
          <include name="*.jar" />
        </fileset>
        <pathelement path="${testclassesdir}" />
        <pathelement path="${classesdir}" />
      </classpath>
      <batchtest todir="${testreportdir}">
        <fileset dir="src/java/test">
          <include name="**/*Test.java" />
          <include name="org/jaxen/javabean/*Test.java" />
        </fileset>
      </batchtest>
    </junit>
  </target>

  <target name="coverage" depends="cover-test">
    <cobertura-report srcdir="src/java/main" destdir="${coveragedir}"/>
  </target>
  
</project>
